import matplotlib.pyplot as plt

def estimate_trend(y, d):
    n = len(y)
    trend = [0]*n
    for t in range(n):
        if d % 2 == 1:  # odd d
            sum_y = sum(y[max(0, t-d//2):min(n, t+d//2+1)])
            count = min(t+1, n-t, d)
        else:  # even d
            sum_y = sum(y[max(0, t-d//2+1):min(n, t+d//2+1)])
            count = min(t+1, n-t, d)
        trend[t] = sum_y / count
    return trend

def estimate_seasonality(y, d, trend):
    n = len(y)
    seasonality = [0]*n
    for t in range(n):
        seasonality[t] = y[t] / trend[t]
    return seasonality

# Example usage:
y = [33604,
33635,
33664,
33695,
33725,
33756,
33786,
33817,
33848,
33878,
33909,
33939,
33970,
34001,
34029,
34060,
34090,
34121,
34151,
34182,
34213,
34243,
34274,
34304,
34335,
34366,
34394,
34425,
34455,
34486,
34516,
34547,
34578,
34608,
34639,
34669,
34700,
34731,
34759,
34790,
34820,
34851,
34881,
34912,
34943,
34973,
35004,
35034,
35065,
35096,
35125,
35156,
35186,
35217,
35247,
35278,
35309,
35339,
35370,
35400,
35431,
35462,
35490,
35521,
35551,
35582,
35612,
35643,
35674,
35704,
35735,
35765,
35796,
35827,
35855,
35886,
35916,
35947, 
35977,
36008,
36039,
36069,
36100,
36130,
36161,
36192,
36220,
36251,
36281,
36312,
36342,
36373,
36404,
36434,
36465,
36495,
36526,
36557,
36586,
36617,
36647,
36678,
36708,
36739,
36770,
36800,
36831,
36861,
36892,
36923,
36951,
36982,
37012,
37043,
37073,
37104,
37135,
37165,
37196,
37226,
37257,
37288,
37316,
37347,
37377,
37408,
37438,
37469,
37500,
37530,
37561,
37591,
37622,
37653,
37681,
37712,
37742,
37773,
37803,
37834,
37865,
37895,
37926,
37956,
37987,
38018,
38047,
38078,
38108,
38139,
38169,
38200,
38231,
38261,
38292,
38322,
38353,
38384,
38412,
38443,
38473,
38504,
38534,
38565,
38596,
38626,
38657,
38687,
38718,
38749,
38777,
38808,
38838,
38869,
38899,
38930,
38961,
38991,
39022,
39052,
39083,
39114,
39142,
39173,
39203,
39234,
39264,
39295,
39326,
39356,
39387,
39417,
39448,
39479,
39508,
39539,
39569,
42339]
 # Time series data
d = 3  # Number of seasons (odd)
# d = 4  # Number of seasons (even)

trend = estimate_trend(y, d)
seasonality = estimate_seasonality(y, d, trend)
# Plotting
plt.figure(figsize=(10, 6))

plt.subplot(3, 1, 1)
plt.plot(y, label='Original Time Series')
plt.legend()

plt.subplot(3, 1, 2)
plt.plot(trend, label='Trend Component')
plt.legend()

plt.subplot(3, 1, 3)
plt.plot(seasonality, label='Seasonality Component')
plt.legend()

plt.tight_layout()
plt.show()



